useDynLib(GenomicAlignments)

import(methods)
importFrom(stats, setNames)
import(BiocGenerics)
import(IRanges)
import(Biostrings)
import(GenomicRanges)
import(Rsamtools)


exportClasses(
    GAlignments,
    GAlignmentPairs,
    GAlignmentsList,
    GappedReads,

    ## Old names:
    GappedAlignments, GappedAlignmentPairs
)


### - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
### Export S3 methods
###


### - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
### Export S4 methods for generics not defined in GenomicAlignments
###

exportMethods(
    c,

    ## Generics defined in IRanges:
    relistReturnedClass,
    narrow,
    coverage,
    pintersect,
    findOverlaps, countOverlaps, overlapsAny, subsetByOverlaps,
    map,
    encodeOverlaps,

    ## Generics defined in GenomicRanges:
    seqinfo, "seqinfo<-",
    seqnames, "seqnames<-",
    seqlevelsInUse,
    granges, grglist, rglist
)


### - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
### Export non-generic functions
###

export(
    validCigar,
    CIGAR_OPS,
    explodeCigarOps, explodeCigarOpLengths,
    cigarToRleList,
    splitCigar,
    cigarRangesAlongReferenceSpace,
    cigarRangesAlongQuerySpace,
    cigarRangesAlongPairwiseSpace,
    extractAlignmentRangesOnReference,
    cigarToIRanges,
    cigarToIRangesListByAlignment, cigarToIRangesListByRName,
    cigarWidthAlongReferenceSpace,
    cigarWidthAlongQuerySpace,
    cigarWidthAlongPairwiseSpace,
    cigarToWidth, cigarToQWidth,
    cigarNarrow, cigarQNarrow,
    cigarOpTable, cigarToCigarTable, summarizeCigarTable,
    queryLoc2refLoc, queryLocs2refLocs,

    GAlignments,
    GAlignmentPairs,
    GAlignmentsList,
    makeGAlignmentsListFromFeatureFragments,

    findMateAlignment, findMateAlignment2,
    makeGAlignmentPairs,
    getDumpedAlignments, countDumpedAlignments, flushDumpedAlignments,

    readGAlignments,
    readGAlignmentPairs,
    readGAlignmentsList,
    readGappedReads,

    sequenceLayer,
    stackStringsFromBam,
    pileLettersAt,

    flipQuery,
    selectEncodingWithCompatibleStrand,
    extractQueryStartInTranscript,

    countCompatibleOverlaps,

    Union, IntersectionNotEmpty, IntersectionStrict,

    ## old stuff (deprecated or defunct):
    GappedAlignments,
    GappedAlignmentPairs,
    makeGappedAlignmentPairs,
    readBamGappedAlignments,
    readBamGappedAlignmentPairs,
    readBamGAlignmentsList,
    readBamGappedReads
)


### - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
### Export S4 generics defined in GenomicAlignments + export corresponding
### methods
###

export(
    ## GAlignments-class.R:
    rname, "rname<-", cigar, qwidth,
    introns,

    ## GAlignmentPairs-class.R:
    first, last, left, right, isProperPair,

    ## GappedReads-class.R:
    qseq,

    ## readGAlignments.R:
    readGAlignmentsFromBam,
    readGAlignmentPairsFromBam,
    readGAlignmentsListFromBam,
    readGappedReadsFromBam,

    ## intra-range-methods.R:
    qnarrow,

    ## encodeOverlaps-methods.R:
    isCompatibleWithSplicing,
    isCompatibleWithSkippedExons,
    extractSteppedExonRanks,
    extractSpannedExonRanks,
    extractSkippedExonRanks,

    ## findCompatibleOverlaps-methods.R:
    findCompatibleOverlaps,

    ## summarizeOverlaps-methods.R:
    summarizeOverlaps,

    ## findSpliceOverlaps-methods.R:
    findSpliceOverlaps
)

### Exactly the same list as above.
exportMethods(
    rname, "rname<-", cigar, qwidth,
    introns,
    first, last, left, right, isProperPair,
    qseq,
    readGAlignmentsFromBam,
    readGAlignmentPairsFromBam,
    readGAlignmentsListFromBam,
    readGappedReadsFromBam,
    qnarrow,
    isCompatibleWithSplicing,
    isCompatibleWithSkippedExons,
    extractSteppedExonRanks,
    extractSpannedExonRanks,
    extractSkippedExonRanks,
    findCompatibleOverlaps,
    summarizeOverlaps,
    findSpliceOverlaps
)

